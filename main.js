(()=>{"use strict";var e=document.querySelector("#card-template").content,t=function(e){e.target.classList.toggle("card__like-button_is-active")},n=function(e){e.target.closest(".card").remove()};function r(t,n,r,o){var c=e.querySelector(".card").cloneNode(!0);c.querySelector(".card__title").textContent=t.name;var a=c.querySelector(".card__image");return a.src=t.link,a.alt=t.name,c.querySelector(".card__delete-button").addEventListener("click",n),c.querySelector(".card__like-button").addEventListener("click",r),a.addEventListener("click",(function(){return o(t)})),c}function o(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",a),e.addEventListener("click",u)}function c(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",a),e.removeEventListener("click",u)}function a(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");t&&c(t)}}function u(e){e.target.classList.contains("popup")&&c(e.target)}var i,s,l,p,d,m={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function f(e,t){return new RegExp("^[".concat(t,"]+$")).test(e)}function _(e,t){e.dataset.error=t,e.classList.add(m.inputErrorClass)}function v(e){e.dataset.error=null,e.classList.remove(m.inputErrorClass)}function y(e){e.querySelectorAll(m.inputSelector).forEach((function(e){e.classList.remove(m.inputErrorClass),v(e)}));var t=e.querySelector(m.submitButtonSelector);t&&(t.classList.add(m.inactiveButtonClass),t.disabled=!0)}s=(i=m).formSelector,l=i.inputSelector,p=i.submitButtonSelector,d=i.inactiveButtonClass,i.inputErrorClass,document.querySelectorAll(s).forEach((function(e){var t=e.querySelector(p);e.addEventListener("input",(function(){var n=e.querySelectorAll(l),r=!0;n.forEach((function(e){f(e.value,"a-zа-яА-ЯёЁ -")?v(e):(_(e,"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы"),r=!1)})),t.classList.toggle(d,!r),t.disabled=!r})),e.querySelectorAll(l).forEach((function(e){e.addEventListener("focus",(function(){return v(e)})),e.addEventListener("blur",(function(){f(e.value,"a-zа-яА-ЯёЁ -")||_(e,"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы")}))}))}));var S={baseUrl:"https://nomoreparties.co/v1/wff-cohort-19",headers:{authorization:"083804d0-404c-4905-a721-c9c4c4534d5a","Content-Type":"application/json"}};function h(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}document.querySelector(".content");var q=document.querySelector(".places__list"),k=document.querySelector(".popup_type_edit"),E=document.querySelector(".popup_type_new-card"),b=document.querySelector(".popup_type_image"),L=function(e){b.querySelector(".popup__image").src=e.link,b.querySelector(".popup__image").alt=b.querySelector(".popup__caption").textContent=e.name,o(b)};[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){q.append(r(e,n,t,L))})),fetch("".concat(S.baseUrl,"/users/me"),{method:"GET",headers:S.headers}).then(h).then((function(e){document.querySelector(".profile__title").textContent=e.name,document.querySelector(".profile__description").textContent=e.about})).catch((function(e){return console.error(e)})),document.querySelector(".profile__edit-button").addEventListener("click",(function(){C.value=document.querySelector(".profile__title").textContent,x.value=document.querySelector(".profile__description").textContent,y(g),o(k)})),document.querySelector(".profile__add-button").addEventListener("click",(function(){j.reset(),y(j),o(E)})),document.querySelectorAll(".popup__close").forEach((function(e){e.addEventListener("click",(function(e){c(e.target.closest(".popup"))}))})),document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",u)}));var g=document.querySelector('.popup__form[name="edit-profile"]'),C=g.querySelector(".popup__input_type_name"),x=g.querySelector(".popup__input_type_description");g.addEventListener("submit",(function(e){e.preventDefault();var t,n=C.value,r=x.value;(t={name:n,job:r},fetch("".concat(S.baseUrl,"/users/me"),{method:"PATCH",headers:S.headers,body:JSON.stringify({name:t.name,about:t.job})}).then(h)).then((function(){document.querySelector(".profile__title").textContent=n,document.querySelector(".profile__description").textContent=r,c(g.closest(".popup"))})).catch((function(e){return console.error(e)}))}));var j=E.querySelector('form[name="new-place"]');j.addEventListener("submit",(function(e){var t;e.preventDefault(),(t={dataCard:{name:j.elements["place-name"].value,link:j.elements.link.value}},fetch("".concat(S.baseUrl,"/cards"),{method:"POST",headers:S.headers,body:JSON.stringify({link:t.dataCard.link,name:t.dataCard.name})}).then(h)).then((function(e){var t=r(e,n);q.prepend(t),c(E),j.reset()})).catch((function(e){return console.error(e)}))}))})();